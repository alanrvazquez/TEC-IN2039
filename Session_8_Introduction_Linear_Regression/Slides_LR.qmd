---
title: |
   | Sesión 8: 
   | Introducción a la Regresión Lineal Simple 
author: 
  - name: Alan R. Vázquez
    email: alanrvazquez@tec.mx
    affiliations:
      - name: Tecnológico de Monterrey
format: revealjs
editor: visual
slide-number: True
logo: IN2039_logo.png
css: style.css
---

# Relationship between two continuous variables

## Principio 1: Formula la pregunta.

Preguntas que podemos contestar con la regression linear simple

-   Is there a relationship between a response variable and predictors?

-   How strong is the relationship?

-   What is the uncertainty?

-   How accurately can we predict a future outcome?

## Example

> If we know a Star Wars character's heigh, can we guess how much they weigh

R plot

# Data = model + error

# $y = f(x) + \epsilon$

## Simple linear regression

$$
y = f(x) + \epsilon
$$

## Simple linear regression

$$
y = f(x) + \epsilon
$$

Continuous (dependent) variable.

## Simple linear regression

$$
y = f(x) + \epsilon
$$

Continuous (independent) variable

## Simple linear regression

$$
y = f(x) + \epsilon
$$

A function that gives the mean value of $y$ at any value of $x$.

## What function do you think we are using to get the mean value of $y$ with simple linear regression?

Relationship between mass and height for Star Wars characters.

# We express the mean mass of the Star Wars character as a *linear function* of their height

## What is the equation that represents this line?

Relationship between mass and height for Star Wars characters.

\[R PLOT\]

## 

$$
y = \beta_0 + \beta_1 x
$$

Relationship between mass and height for Star Wars characters.

\[R PLOT\]

## 

$$
\text{mass} = \beta_0 + \beta_1 (\text{height})
$$

Relationship between mass and height for Star Wars characters.

\[R PLOT\]

## Model interpretation

> What is $\beta_0$?

\[PLOT\]

$\beta_0$ is the average value of the response when $x$ is 0.

## Model interpretation

> Is $\beta_0$ meaningful?

\[PLOT\]

## Model interpretation

> What is $\beta_1$?

\[PLOT\]

$\beta_1$ is the average change in the response when increasing $x$ by one unit.

# Do all points fall exactly on the line?

No!

$$
y = \beta_0 + \beta_1 x + \epsilon
$$

Show errors in plot

## The true model

$$
y = \beta_0 + \beta_1 x + \epsilon
$$

-   If we had the whole population of the Star Wars universe, we could quantify the exact relationship between $x$ and $y$.

## The reality

$$
\hat{y} = \hat{\beta}_0 + \hat{\beta}_1 x 
$$

-   In reality, we have a sample of Star Wars characters to estimate the relationship between $x$ and $y$ (height and mass).

-   The "hats" represent the estimated (fitted) values.

# Let's do this in R

## Simple linear regression in R

show code

## Interpretation

Show code

For every **one centimeter** increase in height, a Star Wars characters weight **on average** increases by 0.62.

# For every one unit increase in $x$, the expected change in $y$ is $\hat{\beta}_1$

## Why do we fit a linear model?

-   It reduces the dimensionality of the data (from an $n$ by 2 table to only two numbers).

-   To get a sense of the relationship between $x$ and $y$ for a "typical observation.

    -   When is this an accurate representation?

# Where did these $\hat{y}$ values come from?

![](images/Screenshot%202024-01-30%20at%204.08.35%20p.m..png)

## How did we choose this line?

Show line

## Minimize the residuals

Show residuals

## Minimize the least squares

Plot with least squares.

## Residuals are important

Technically, a residual is calculated as

$$
e_i = y_i - \hat{y}_i
$$

The behaviour of the residuals tells you whether your model is correct or not.

## Residual analysis

Two important assumptions of the residuals

1.  Constant Variance
2.  Independence

## Constant Variance

Plot as in our course.

## Independence

Plot as in our course

## Transformaciones

También buscamos ver si una transformación de una u otra característica o de ambas conduce a una relación lineal.

Esto se puede hacer aplicando la función `log()` a una de las variables.

```{r}
#| fig-pos: center
#| echo: false

gf_point(log(mpg) ~ weight, data = auto_data)
```

## El efecto de una transformación

El efecto de una transformación es "linealizar" la relación entre las variables.

::: columns
::: {.column width="50%"}
```{r}
#| fig-pos: center
#| echo: true

gf_point(mpg ~ weight, 
         data = auto_data)
```
:::

::: {.column width="50%"}
```{r}
#| fig-pos: center
#| echo: true

gf_point(log(mpg) ~ weight, 
         data = auto_data)
```
:::
:::

El diagrama de dispersión de la derecha explora la relación $log(Y) = X$. O , qeuivalentemente, la relación $Y = e^X$.

## Transformaciones

Otra forma común de ajustar la escala es transformar los datos o los ejes del gráfico. Usamos transformaciones para datos sesgados para que sea más fácil inspeccionar la distribución.

Y cuando la transformación produce una distribución simétrica, la simetría conlleva propiedades útiles para el modelado (que veremos más adelante).

Hay varias formas de transformar datos, pero la transformación de registros tiende a ser especialmente útil.

## La transformación del registro

La transformación logarítmica puede revelar varios tipos comunes de relaciones. Debido a esto, la transformación logarítmica se considera la navaja de las transformaciones.


# Actividad

## Application Excercise

1.  Go to [lucy.shinyapps.io/least-squares/](https://lucy.shinyapps.io/least-squares/)

2.  This shows a scatter plot of 10 data points with a line estimating the relationship between `x` and `y`. Drag the blue points to change the line.

3.  See if you can find a line that minimizes the sum of square errors
